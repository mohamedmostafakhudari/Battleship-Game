(()=>{var e={508:e=>{function t(e){var r,o,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(r=0;r<s;r++)e[r]&&(o=t(e[r]))&&(n&&(n+=" "),n+=o)}else for(o in e)e[o]&&(n&&(n+=" "),n+=o);return n}function r(){for(var e,r,o=0,n="",s=arguments.length;o<s;o++)(e=arguments[o])&&(r=t(e))&&(n&&(n+=" "),n+=r);return n}e.exports=r,e.exports.clsx=r},427:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var o=r(354),n=r.n(o),s=r(314),i=r.n(s)()(n());i.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/main.css"],names:[],mappings:"AAAA;QACQ,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const a=i},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",o=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),o&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),o&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,o,n,s){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(i[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&i[d[0]]||(void 0!==s&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=s),r&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=r):d[2]=r),n&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),t.push(d))}},t}},354:e=>{"use strict";e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),s="/*# ".concat(n," */");return[t].concat([s]).join("\n")}return[t].join("\n")}},522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>v});var o=r(72),n=r.n(o),s=r(825),i=r.n(s),a=r(659),l=r.n(a),c=r(56),d=r.n(c),h=r(540),u=r.n(h),p=r(113),f=r.n(p),y=r(427),g={};g.styleTagTransform=f(),g.setAttributes=d(),g.insert=l().bind(null,"head"),g.domAPI=i(),g.insertStyleElement=u(),n()(y.A,g);const v=y.A&&y.A.locals?y.A.locals:void 0},72:e=>{"use strict";var t=[];function r(e){for(var r=-1,o=0;o<t.length;o++)if(t[o].identifier===e){r=o;break}return r}function o(e,o){for(var s={},i=[],a=0;a<e.length;a++){var l=e[a],c=o.base?l[0]+o.base:l[0],d=s[c]||0,h="".concat(c," ").concat(d);s[c]=d+1;var u=r(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var f=n(p,o);o.byIndex=a,t.splice(a,0,{identifier:h,updater:f,references:1})}i.push(h)}return i}function n(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,n){var s=o(e=e||[],n=n||{});return function(e){e=e||[];for(var i=0;i<s.length;i++){var a=r(s[i]);t[a].references--}for(var l=o(e,n),c=0;c<s.length;c++){var d=r(s[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}s=l}}},659:e=>{"use strict";var t={};e.exports=function(e,r){var o=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var o="";r.supports&&(o+="@supports (".concat(r.supports,") {")),r.media&&(o+="@media ".concat(r.media," {"));var n=void 0!==r.layer;n&&(o+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),o+=r.css,n&&(o+="}"),r.media&&(o+="}"),r.supports&&(o+="}");var s=r.sourceMap;s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},569:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=new class{constructor(){}query(e){return document.querySelector(e)}queryAll(e){return document.querySelectorAll(e)}on(e,t,r){e.addEventListener(t,r)}off(e,t,r){e.removeEventListener(t,r)}createElement(e,t={},r=""){const o=document.createElement(e);for(let e in t)o.setAttribute(e,t[e]);return r&&(o.innerHTML=r),o}toggleClass(e,t){e.classList.toggle(t)}append(e,t){e.appendChild(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}};t.default=r},606:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GameboardUI=t.Gameboard=void 0;const n=o(r(80)),s=o(r(569)),i=o(r(508));class a{constructor(e){this.gameboardUIInstance=e,this.board=Array.from({length:a.size},(()=>Array.from({length:a.size},(()=>({cell:"",hidden:!1}))))),this.ships=[],this.gameboardUIInstance.render({board:this.board})}static get Size(){return a.size}get Board(){return this.board}placeShip({coords:e,length:t,horizontal:r=!1}){let o,s;if(this.isValidCoords({coords:e,length:t,horizontal:r})){const i=new n.default(t);this.ships.push(i),r?this.placeHorizontalShip({ship:i,coords:e,length:t}):this.placeVerticalShip({ship:i,coords:e,length:t}),o=!1,s="A ship has been added successfully"}else o=!0,s="Invalid ship placement";return this.gameboardUIInstance.render({board:this.board}),console.log(o,s),{error:o,message:s}}receiveAttack(e){const{y:t,x:r}=e,o=this.board[t][r];return o.hidden=!1,"x"===o.cell||"#"===o.cell?{error:!0,message:"the cell has already been hit."}:(""===o.cell||"."===o.cell?this.board[t][r].cell="x":"object"==typeof o.cell&&(o.cell.hit(),this.board[t][r].cell="#"),this.gameboardUIInstance.render({board:this.board}),{error:!1,message:"a cell has been hit successfully"})}isAllShipsSunk(){for(const e of this.ships)if(console.log(e),!e.isSunk())return!1;return!0}getPossibleAttackTargets(){const e=[];for(let t=0;t<a.size;t++)for(let r=0;r<a.size;r++)""!==this.board[t][r].cell&&"."!==this.board[t][r].cell&&"object"!=typeof this.board[t][r].cell||e.push({y:t,x:r});return e}getValidPlacementCoords({shipLength:e,horizontal:t=!1}){const r=[];for(let o=0;o<a.size;o++)for(let n=0;n<a.size;n++)this.isValidCoords({coords:{y:o,x:n},length:e,horizontal:t})&&r.push({y:o,x:n});return r}clear(){this.board=Array.from({length:a.size},(()=>Array.from({length:a.size},(()=>({cell:"",hidden:!1}))))),this.ships=[],this.gameboardUIInstance.render({board:this.board})}hideCells(){for(let e=0;e<this.board.length;e++)for(let t=0;t<this.board.length;t++)this.board[e][t].hidden=!0;this.gameboardUIInstance.render({board:this.board})}placeHorizontalShip({ship:e,coords:t,length:r}){t.x-1>=0&&(this.board[t.y][t.x-1].cell=".");for(let o=t.x;o<t.x+r;o++)this.board[t.y][o].cell=e,t.y-1>=0&&(this.board[t.y-1][o].cell="."),t.y+1<a.size&&(this.board[t.y+1][o].cell=".");r+t.x<a.size&&(this.board[t.y][r+t.x].cell=".")}placeVerticalShip({ship:e,coords:t,length:r}){t.y-1>=0&&(this.board[t.y-1][t.x].cell=".");for(let o=t.y;o<t.y+r;o++)this.board[o][t.x].cell=e,t.x-1>=0&&(this.board[o][t.x-1].cell="."),t.x+1<a.size&&(this.board[o][t.x+1].cell=".");r+t.y<a.size&&(this.board[r+t.y][t.x].cell=".")}isValidCoords({coords:e,length:t,horizontal:r}){const{y:o,x:n}=e,s=n>=0&&n<a.size&&o>=0&&o<a.size;let i,l,c=[];if(r){for(let e=0;e<t;e++)if(Array.isArray(this.board[o])){if(n+e>a.Size-1)break;c.push({y:o,x:n+e})}}else for(let e=0;e<t;e++)if(Array.isArray(this.board[o+e])){if(o+e>a.Size-1)break;c.push({y:o+e,x:n})}return i=c.every((e=>{const{y:t,x:r}=e,o=[{y:t+1<a.Size?t+1:a.Size-1,x:r},{y:t-1>0?t-1:0,x:r},{y:t,x:r+1<a.Size?r+1:a.Size-1},{y:t,x:r-1>0?r-1:0}];return""===this.board[t][r].cell&&o.every((e=>""===this.board[e.y][e.x].cell))})),l=s&&i&&c.length===t&&(r?n+t<a.size-1:o+t<a.size-1),l}}t.Gameboard=a,a.size=10,t.GameboardUI=class{constructor(e){this.container=e,this.placeShipDialog=s.default.query("#place-ship-dialog"),this.bindEvents()}render({board:e}){if(this.container){this.container.innerHTML="";const t="bg-green-600",r="bg-sky-500/50",o="bg-gray-300/50",n="bg-red-700",l=s.default.createElement("div",{class:"board w-[400px] grid",style:`grid-template-columns: repeat(${a.Size},1fr);`});for(let a=0;a<e.length;a++)for(let c=0;c<e.length;c++){const d=e[a][c],h=this.getCellType(d.cell),u="bg-slate-600",p=(0,i.default)("cell relative aspect-square border border-slate-300","ship"===h&&t,"miss"===h&&r,"reserved"===h&&o,"damage"===h&&n,d.hidden&&u),f=s.default.createElement("div",{class:p,"data-coords":`${a},${c}`});l.appendChild(f)}this.container.appendChild(l)}}searchBoardForDialogBtnMatch(e){if(this.container){const t=this.container.firstElementChild;if(t){const r=[...null==t?void 0:t.children];for(const t of r)if(t.getAttribute("data-coords")===e)return t}}}bindEvents(){var e;null===(e=this.placeShipDialog)||void 0===e||e.addEventListener("mouseover",(e=>{const t=e.target.closest("button");if(!t)return;const r=t.textContent;if(r){const e=this.searchBoardForDialogBtnMatch(r);null==e||e.classList.add("bg-red-500"),t.addEventListener("mouseleave",(()=>{null==e||e.classList.remove("bg-red-500")}))}}))}getCellType(e){return"object"==typeof e?"ship":"x"===e?"miss":"."===e?"reserved":"#"===e?"damage":"empty"}},t.default=a},538:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComputerPlayer=t.HumanPlayer=t.Player=void 0;class r{constructor(e,t,r){this.boardInstance=t,this.opponentBoardInstance=r,this.type=e}get BoardInstance(){return this.boardInstance}get Type(){return this.type}}t.Player=r,t.HumanPlayer=class extends r{constructor(e,t){super("player",e,t)}attack({coords:e}){if(!e)throw new Error("Coords is required to execute an attack from a human player");this.opponentBoardInstance.receiveAttack(e)}},t.ComputerPlayer=class extends r{constructor(e,t){super("computer",e,t),this.nextHitsQueue=[],this.visited=[]}attack(){const e=this.opponentBoardInstance.getPossibleAttackTargets(),t=this.nextHitsQueue.length?this.nextHitsQueue.shift():e[Math.floor(Math.random()*e.length)];if(console.log(this.visited),console.log(this.nextHitsQueue),console.log(e),console.log(t),t){if(this.opponentBoardInstance.receiveAttack(t),this.visited.some((e=>e.y===t.y&&e.x===t.x)))return;const r=this.opponentBoardInstance.Board[t.y][t.x];if("#"===r.cell){const r=[[t.y-1,t.x],[t.y+1,t.x],[t.y,t.x-1],[t.y,t.x+1]];for(const t of r){const[r,o]=t,n={y:r,x:o};e.some((e=>e.y===n.y&&e.x===n.x))&&this.nextHitsQueue.push(n)}}this.visited.push(t),"#"===r.cell&&this.attack()}}}},80:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.length=e,this.hits=0}hit(){this.isSunk()||(this.hits+=1)}isSunk(){return this.hits===this.length}}},468:function(e,t,r){"use strict";var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(n,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(r(569));class i{static createPlaceShipDialogButton(e){const{y:t,x:r}=e,o=document.createElement("button");return o.className="bg-blue-600 text-white rounded-lg w-16 py-1 text-lg",o.textContent=`${t},${r}`,o}static updatePlaceShipDialogContent({ship:e,possibleCoords:t}){var r,o,n;const s=null===(r=this.placeShipDialog)||void 0===r?void 0:r.querySelector(".ship-type"),a=null===(o=this.placeShipDialog)||void 0===o?void 0:o.querySelector(".ship-length"),l=null===(n=this.placeShipDialog)||void 0===n?void 0:n.querySelector(".possible-coords");if(s&&a&&l&&(s.textContent=e.type,a.textContent=e.length+"",t)){l.innerHTML="";for(const e of t){const t=i.createPlaceShipDialogButton(e);l.appendChild(t)}}}static openPlaceShipDialog(){i.placeShipDialog.showModal()}static closePlaceShipDialog(){i.placeShipDialog.close()}static openGameResultDialog({winner:e}){const t=i.gameResultDialog.querySelector(".winner");e.match(/player/i)?null==t||t.classList.add("text-blue-500"):e.match(/computer/i)&&(null==t||t.classList.add("text-red-500")),t&&(t.textContent=e),i.gameResultDialog.showModal()}static closeGameResultDialog(){i.gameResultDialog.close()}}i.placeShipDialog=s.default.query("#place-ship-dialog"),i.gameResultDialog=s.default.query("#game-result-dialog"),t.default=class{constructor({player1:e,player2:t}){this.ships=[{type:"carrier",length:5},{type:"battleship",length:4},{type:"destroyer",length:3},{type:"submarine",length:3},{type:"patrol boat",length:2}],this.currentMode="idle",this.currentTurn=1,this.placementMode="vertical",this.playerOne=e,this.playerTwo=t,this.winner=null,this.gameOver=!1,this.placeShipDialog=s.default.query("#place-ship-dialog")}get CurrentMode(){return this.currentMode}set CurrentMode(e){this.currentMode=e}get PlacementMode(){return this.placementMode}set PlacementMode(e){this.placementMode=e}startGame(){var e;null===(e=this.playerTwo)||void 0===e||e.BoardInstance.hideCells(),this.runPlacement()}runPlacement(){return o(this,void 0,void 0,(function*(){var e,t,r,o,n,s,a,l;this.CurrentMode="placement",i.openPlaceShipDialog();for(let n=0;n<this.ships.length;n++)if(null===(e=this.playerOne)||void 0===e?void 0:e.BoardInstance){this.calcPossibleCoords({board:null===(t=this.playerOne)||void 0===t?void 0:t.BoardInstance,ship:this.ships[n],horizontal:"horizontal"===this.placementMode});const e=yield this.getShipPlacementCoords({board:null===(r=this.playerOne)||void 0===r?void 0:r.BoardInstance,ship:this.ships[n],horizontal:"horizontal"===this.placementMode});null===(o=this.playerOne)||void 0===o||o.BoardInstance.placeShip({coords:e,length:this.ships[n].length,horizontal:"horizontal"===this.placementMode})}if(i.closePlaceShipDialog(),"computer"===(null===(n=this.playerTwo)||void 0===n?void 0:n.Type))for(let e=0;e<this.ships.length;e++){let t=!(Math.random()-.5<0),r=null===(s=this.playerTwo)||void 0===s?void 0:s.BoardInstance.getValidPlacementCoords({shipLength:this.ships[e].length,horizontal:t});r.length||(r=null===(a=this.playerTwo)||void 0===a?void 0:a.BoardInstance.getValidPlacementCoords({shipLength:this.ships[e].length,horizontal:!t}),t=!t),r&&(null===(l=this.playerTwo)||void 0===l||l.BoardInstance.placeShip({coords:r[Math.floor(Math.random()*r.length)],length:this.ships[e].length,horizontal:t}))}}))}getShipPlacementCoords(e){return o(this,arguments,void 0,(function*({board:e,ship:t,horizontal:r}){return new Promise(((r,o)=>{var n,s;const i=null===(n=this.placeShipDialog)||void 0===n?void 0:n.querySelector(".horizontal");i&&(i.onchange=r=>{this.placementMode="horizontal"===this.placementMode?"vertical":"horizontal",this.calcPossibleCoords({board:e,ship:t,horizontal:"horizontal"===this.placementMode})}),null===(s=this.placeShipDialog)||void 0===s||s.addEventListener("click",(e=>{var t;const o=e.target.closest("button");if(!o)return;const n=null===(t=o.textContent)||void 0===t?void 0:t.split(",");if(n){const[e,t]=n;r({y:+e,x:+t})}}))}))}))}calcPossibleCoords({board:e,ship:t,horizontal:r}){const o=e.getValidPlacementCoords({shipLength:t.length,horizontal:r});i.updatePlaceShipDialogContent({ship:t,possibleCoords:o})}playRound({playerOneAttackCoords:e}){var t,r,o;if(!this.playerOne||!this.playerTwo)return;if(this.gameOver)return;let n;null===(t=this.playerOne)||void 0===t||t.attack({coords:e}),n=this.checkWinner(),n&&(this.declareWinner(n),this.winner=n,this.gameOver=!0),"#"!==(null===(r=this.playerTwo)||void 0===r?void 0:r.BoardInstance.Board[e.y][e.x]).cell&&(null===(o=this.playerTwo)||void 0===o||o.attack({}),n=this.checkWinner(),n?(this.declareWinner(n),this.winner=n,this.gameOver=!0):this.nextTurn())}nextTurn(){this.currentTurn++}checkWinner(){var e,t,r;return!(!this.playerOne||!this.playerTwo)&&(console.log(null===(e=this.playerTwo)||void 0===e?void 0:e.BoardInstance.isAllShipsSunk()),(null===(t=this.playerOne)||void 0===t?void 0:t.BoardInstance.isAllShipsSunk())?this.playerTwo:!!(null===(r=this.playerTwo)||void 0===r?void 0:r.BoardInstance.isAllShipsSunk())&&this.playerOne)}declareWinner(e){i.openGameResultDialog({winner:e.Type})}resetState(){var e,t;this.playerOne&&this.playerTwo&&(null===(e=this.playerOne)||void 0===e||e.BoardInstance.clear(),null===(t=this.playerTwo)||void 0===t||t.BoardInstance.clear()),this.currentTurn=1,this.winner=null,this.gameOver=!1,this.placementMode="vertical"}closeGameResultDialog(){i.closeGameResultDialog()}}},156:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(522);const n=o(r(569)),s=o(r(468)),i=r(538),a=r(606),l=n.default.query("#player-one-board-container"),c=n.default.query("#player-two-board-container"),d=new a.Gameboard(new a.GameboardUI(l)),h=new a.Gameboard(new a.GameboardUI(c));h.hideCells(),null==c||c.addEventListener("click",(e=>{const t=e.target.closest(".cell");if(!t)return;const r=t.dataset.coords;if(r){const[e,t]=r.split(",");if("x"===p.BoardInstance.Board[+e][+t].cell||"#"===p.BoardInstance.Board[+e][+t].cell)return;f.playRound({playerOneAttackCoords:{y:+e,x:+t}})}}));const u=new i.HumanPlayer(d,h),p=new i.ComputerPlayer(h,d),f=new s.default({player1:u,player2:p}),y=n.default.query("#start-game-btn");null==y||y.addEventListener("click",(()=>{f.resetState(),f.startGame(),y.textContent="Restart"}));const g=n.default.query("#game-result-dialog"),v=g.querySelector(".close-btn"),m=g.querySelector(".again-btn");null==v||v.addEventListener("click",(e=>{f.closeGameResultDialog()})),null==m||m.addEventListener("click",(e=>{f.closeGameResultDialog(),f.resetState(),f.startGame()}))}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={id:o,exports:{}};return e[o].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0,r(156)})();
//# sourceMappingURL=main.df971fec4c5f019d2cdb.js.map